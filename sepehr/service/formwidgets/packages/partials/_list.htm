<table class="table">
    <thead>
    <tr>
        <th>ردیف</th>
        <th>کد پستی گیرنده</th>
        <th>آدرس گیرنده</th>
        <th>نوع ارسال پست</th>
        <th>نوع بسته پستی</th>
        <th>نوع بیمه پستی</th>
        <th>عملیات</th>
    </tr>
    </thead>

    <tbody>

    <a href="#" data-toggle="modal" data-target="#package-modal"
       id="btn-newPack"
       data-request-success="dataRequestUpdate()"
       class="btn btn-success btn-embossed btnCreatePackage center" style="width:150px;text-align: center"
    >بسته جدید</a>

    <?php $count = 1 ?>
    <?php foreach ($model->packages as $key => $package): ?>
        <tr class="<?= $package['is_rejected'] == false ? 'bg-success' : 'bg-danger' ?>">
            <td width="5%"> <?= $count ?></td>
            <td><?= $package['receiver_postal_code'] ?></td>
            <td><?= $package['receiver_address'] ?></td>
            <td><?= $service->getPostType($package['post_type_id']) ?></td>
            <td><?= $service->getPackageType($package['package_type_id']) ?></td>
            <td><?= $service->getInsuranceType($package['insurance_type_id']) ?></td>
            <td>
                <a
                        href="#"
                        class="btn btn-default btnEdit"
                        data-toggle="modal"
                        data-target="#package-modal"
                        data-request="onGetId"
                        data-request-data=id:"<?= $key ?>"
                        data-request-update="'list':'.packages'"
                        data-id="<?= $key ?>"


                >
                    ویرایش
                </a>

                <a
                        href="#"
                        class="btn btn-default"
                        data-request="onDeletePackage"
                        data-request-data="id:<?= $key ?>"
                        data-id="<?= $key ?>"
                        data-request-confirm="آیا از حذف رکورد مطمئن هستید؟"
                        data-request-update="'list':'.packages'"
                >
                    حذف
                </a>
            </td>
        </tr>
        <?php $count++ ?>
    <?php endforeach; ?>
    </tbody>
</table>

<script type="text/javascript">
    $(document).ready(function () {
        $(".btnEdit").click(function () {

            //packages = "<?//= json_encode($packages)?>//";
            let id = $(this).attr('data-id');
            console.log('id', id);
            $("input[name='package_id']").val(id);


            console.log(packages);
            // $("input[name='receiver_postal_code']").val(packages[id].receiver_postal_code);
            $("input[name='receiver_postal_code']").val('salammmmmmmmmmmmmmmmmmmmmmm');
            $("input[name='receiver_address']").val(packages[id].receiver_address);
            $("input[name='weight']").val(packages[id].weight);
            $("select[name='post_type_id']").val(packages[id].post_type_id).change();
            $("select[name='package_type_id']").val(packages[id].package_type_id).change();
            $("select[name='insurance_type_id']").val(packages[id].insurance_type_id).change();
            $("select[name='distribution_time_id']").val(packages[id].distribution_time_id).change();
            $("select[name='special_services_id']").val(packages[id].special_services_id).change();

            $('#package-modal').find('.modal-title').text('فرم ویرایش بسته');
            $('#package-modal').find('#btn-edit').removeClass('hide');
            $('#package-modal').find('#btn-save').addClass('hide');

        });

        $("#btn-newPack").click(function () {
            $('#my-form')[0].reset();
            $('span.select2-selection__rendered').text('انتخاب کنید');

            $('#package-modal').find('.modal-title').text('فرم ایجاد بسته جدید');
            $('#package-modal').find('#btn-edit').addClass('hide');
            $('#package-modal').find('#btn-save').removeClass('hide');

        });
    });

</script>